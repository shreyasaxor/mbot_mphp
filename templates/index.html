<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Regression test strategic agent</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="../bower_components/font-awesome/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="../bower_components/Ionicons/css/ionicons.min.css">

    <link rel="stylesheet" href="../bower_components/select2/dist/css/select2.min.css">
    <link rel="stylesheet" href="../bower_components/dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="../bower_components/dist/css/skins/_all-skins.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

    <!-- Google Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
</head>
<style>
    .content-wrapper,
    .main-footer {
        margin-left: 0px;
    }
</style>

<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">

        <header class="main-header">

            <!-- Logo -->
            <a class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->

                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg">CSI Storage</span>
            </a>

            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->

                <!-- Navbar Right Menu -->

            </nav>
        </header>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <h1>
                Regression Test Strategic Agent
                </h1>

            </section>

            <!-- Main content -->
            <section class="content">
                <div class="row">
                        <div class="col-md-12">
                                <div class="box box-info">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">What do you want to qualify?</h3>
                                    </div>
                                    <div class="box-body">
                                        <div class="row">
                                            <!-- Left col -->
                                            <div class="col-md-8" style="border-right:1px #d2d6de ">
                                                <div class="input-group input-group-sm">
                                                    <input type="text" class="form-control" id="myText" value="" style=" width: 100%;">
                                                    <span class="input-group-btn">
                                                        <button type="button" class="btn btn-success btn-flat" style="width: 100%;" onclick="UserAction()">Recommend</button>
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="col-md-4" style="border-right:1px #d2d6de ">

                                                <div class="info-box bg-aqua">
                                                        <span class="info-box-icon"><i class="ion-android-time"></i></span>

                                                        <div class="info-box-content">
                                                            <span class="info-box-text">Estimation</span>
                                                            <span class="info-box-number" id='_esthours'></span>
                                                            <div class="progress">
                                                                <div class="progress-bar" style="width: 100%"></div>
                                                            </div>
                                                            <span class="progress-description" id='_estdays'></span>
                                                        </div>
                                                        <!-- /.info-box-content -->
                                                </div>
                                            </div>

                                            <!--
                                            <div class="col-md-6">
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <div class="form-group" style="">

                                                            <select class="form-control select2" multiple="multiple"  id="country">

                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="form-group " style="">

                                                            <select class="form-control select2" multiple="multiple" id="state" >

                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="form-group " style="">

                                                            <select class="form-control select2" multiple="multiple" id="city">

                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <button type="submit" class="btn btn-success">Recommend</button>
                                                    </div>
                                                </div>
                                            </div>
                                            -->
                                            <!-- /input-group -->
                                        </div>

                                        <div class="row">
                                            <!-- Left col -->
                                            <div class="col-md-8" style="border-right:1px #d2d6de;/* margin-top: -39px; */">
                                                <input type="checkbox" id="chk_common" value="Bike" checked="">Include common test cases<br>
                                            </div>
                                        </div>

                                        <!-- /.box-body -->
                                    </div>
                                </div>
                            </div>



                    <!-- /.col -->
                </div>
                <!-- Main row -->
                <div class="row">
                    <!-- Left col -->
                    <div class="col-md-5">
                        <div class="box box-info">
                            <div class="box-header with-border">
                                <h3 class="box-title">Top 5 recommended test configurations</h3>
                            </div>
                            <!-- Info Boxes Style 2 -->
                            <div id="sidenav_id">



                            </div>
                       </div>
                    </div>

                    <div class="col-md-7">

                            <div class="box box-info">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">Recommended Test cases</h3>

                                        <div class="box-tools pull-right">
                                           <!-- <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                                            </button>
                                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                                            -->
                                        </div>
                                    </div>
                                    <!-- /.box-header -->
                                    <div class="box-body">
                                        <div class="table-responsive">
                                            <table class="table no-margin" id="myTable" style="margin-top:35px">
                                                <thead>
                                                    <tr>
                                                       <th width="20%">Test Case ID</th>
                                                        <th>Test Case Name</th>
                                                        <th width="20%">Failure chance</th>
                                                    </tr>
                                                </thead>
                                                <tbody>

                                                </tbody>
                                            </table>
                                        </div>
                                        <!-- /.table-responsive -->
                                    </div>
                                    <!-- /.box-body -->

                                    <!-- /.box-footer -->
                                </div>
                    <!--
                        <div class="box box-default">
                            <div class="box-header with-border">
                                <h3 class="box-title">Predicted Result(Not yet)</h3>

                                <div class="box-tools pull-right">
                                    <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                                    </button>
                                    <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                                </div>
                            </div>
                            <div class="box-body">
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="chart-responsive">
                                            <canvas id="chart-area" height="150"></canvas>
                                        </div>
                                    </div>


                                </div>

                            </div>

                        </div>

                    -->
                    </div>
                </div>

                    <!-- /.col -->
                </div>
                <div class="row">
                    <!-- Left col -->
                    <div class="col-md-12">
                        <!--
                            <div class="box box-default">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">Predicted Result(Not yet implemented)</h3>

                                    </div>
                                    <div class="box-body">
                                        <div class="row">
                                            <div class="col-md-10">
                                                <div class="chart-responsive">
                                                    <canvas id="chart-area" height="50"></canvas>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            -->
                    </div>
                </div>
                <!-- /.row -->
            </section>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->

        <footer class="main-footer">
            <div class="pull-right hidden-xs">

            </div>
            <strong>Copyright &copy; 2019 <a href="">Mphasis</a>.</strong> All rights reserved.
        </footer>

        <!-- Control Sidebar -->

        <!-- /.control-sidebar -->
        <!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>

    </div>
    <!-- ./wrapper -->

    <!-- jQuery 3 -->
    <script src="../bower_components/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap 3.3.7 -->
    <script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <script src="../bower_components/select2/dist/js/select2.full.min.js"></script>
    <script src="../bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
	<script src="../bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
   <script type="text/javascript"  src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.print.min.js"></script>
    <!-- AdminLTE App -->
    <script src="../bower_components/dist/js/adminlte.min.js"></script>

    <script src="../bower_components/chart.js/Chart.js"></script>
    <!-- AdminLTE dashboard demo (This is only for demo purposes) -->

    <!-- AdminLTE for demo purposes -->
    <script src="../bower_components/dist/js/demo.js"></script>
<script>


//var color =['bg-green','bg-red','bg-yellow','bg-aqua','bg-blue','bg-navy','bg-teal']
var color =['bg-blue','bg-teal','bg-blue','bg-teal','bg-blue']

function getRandomArbitrary(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}
window.onload = function() {
	 $('.select2').select2();

	  var ctx = document.getElementById("chart-area").getContext("2d");
            window.myDoughnut = new Chart(ctx).Doughnut(doughnutData, {
                responsive: true
            });

        	$('#myTable').DataTable({
				  'paging'      : true,
				  'lengthChange': false,
				  'searching'   : false,
				  'ordering'    : false,
				  'info'        : true,
				  'autoWidth'   : false,
				  dom: 'Blfrtip',
				  'buttons': [
					'copy', 'csv', 'excel', 'pdf', 'print'
					]
				});


}
function UserAction() {

		 var xhttp = new XMLHttpRequest();
		  xhttp.onreadystatechange = function() {
				 if (this.readyState == 4 && this.status == 200) {

								 var response = this.responseText ;

								 if(response != ''){
									var tableData = jQuery.parseJSON(response);
									var	table	  = '';
                                    var test_id, test_name, test_rank, test_result;

                                    $('#myTable').dataTable().fnClearTable();
                                    oTable = $('#myTable').dataTable();

                                    var est = 0;

									$.each( tableData, function( key, value ) {
										//table	+= '<tr><td>'+value.TestcaseID+'</td><td>'+value.TestCase+'</td><td>'+value.Rank+'</td><td>'+value.Result+'</td><td></td></tr>';
										//table	+= '<tr><td></td><td>'+ value.TestCase +'</td><td></td><td>TBD</td></tr>';

                                        test_id = '<td>'+ value.TEST_ID +'</td>';
                                        test_name = '<td>'+ value.TestCase +'</td>';
                                        test_rank = '<td></td>';

                                        failure = Number((Number (1) - Number(value.TEST_STATUS))*100).toFixed(0);

                                        est = Number(est) + Number(value.Effort)



                                        if (failure < 25 )
                                            test_result = '<td> <font color="green">' + failure + ' % </font></td>';
                                        else if (failure < 75 )
                                            test_result = '<td> <font color="orange">' + failure + ' % </font></td>';
                                        else
                                            test_result = '<td> <font color="red">' + failure + ' % </font></td>';

                                        var tableData = [
                                                        test_id,
                                                        test_name,
                                                        //test_rank,
                                                        test_result
                                                        ];

                                        oTable.fnAddData(tableData);

									});

                                    $("#_esthours").text(Number(Number(est)/60).toFixed(2) + " Hours");
                                    //$("#_estdays").text("Each configuration need " (Number(est)/8) + " person days");
                                    $("#_estdays").text("Each configuration need " + Number(Number((Number(est)/60))/8).toFixed(2) + " person days");



								//	$('#myTable tbody').empty();
								//$('#myTable tbody').append(table);


		   }


				 }
			};

			var param = '{"query":"' + document.getElementById("myText").value + '","include_common": "' + document.getElementById("chk_common").checked + '"}';

			xhttp.open("POST", "http://127.0.0.1:8000/testcase/", true);
			xhttp.setRequestHeader("Content-type", "application/json");
			xhttp.send(param);
            side_nav_bar(param)
}

function side_nav_bar(param){

    var sine_nav =""
    var xhttp = new XMLHttpRequest();
		  xhttp.onreadystatechange = function() {
				 if (this.readyState == 4 && this.status == 200) {

								 var response = this.responseText ;

								 if(response != ''){
									var responsedata = jQuery.parseJSON(response);

                                    var config ;
                                    $.each( responsedata, function( key, value ) {
                                        if(key <5){
                                           //var colors = color[Number(getRandomArbitrary(0,4))]
                                           var colors = color[Number(key)]

                                            if ((key % 2) == 0)
                                                config = value.Config + "SAS|SATA|SSD|UEFI";
                                            else
                                                config = value.Config + "SAS|SATA|SSD|LEGACY";

                                            sine_nav	+= '<div class="info-box '+colors+'"><span class="info-box-icon">'+(Number(key)+1)+'</span><div class="info-box-content"><span class="info-box-text">'+value.Heading+'</span><span class="info-box-number">'+ config  +'</span></div></div>';

                                        }
									});


                                    var e = document.getElementById('sidenav_id');
                                    e.innerHTML= sine_nav

		   }


				 }
			};

			var param = param

			xhttp.open("POST", "http://127.0.0.1:8000/config/", true);
			xhttp.setRequestHeader("Content-type", "application/json");
			xhttp.send(param);


}

var myJson = {
    "country": [
        {
            "name": "Windows",
            "id": "windows",
            "states": [
                {
                    "name": "Server1",
                    "id": "server1",
                    "cities": [
                        {
                            "name": "Controller 1",
                            "id": "controller1",
                        },
                        {
                            "name": "Controller 2",
                            "id": "controller2",
                        },
                        {
                            "name": "Controller 3",
                            "id": "controller 3",
                        },
                    ]
                },
                {
                    "name": "Server 2",
                    "id": "server2",
                    "cities": [
                        {
                            "name": "Controller 3",
                            "id": "controller 3",
                        },
                        {
                            "name": "Controller 4",
                            "id": "controller 4",
                        },
                        {
                            "name": "Controller 5",
                            "id": "controller 5",
                        }
                    ]
                }
            ]
        },
        {
            "name": "RHEL",
            "id": "aus",
            "states": [
            {
                    "name": "Server1",
                    "id": "server1",
                    "cities": [
                        {
                            "name": "Controller 1",
                            "id": "controller1",
                        },
                        {
                            "name": "Controller 2",
                            "id": "controller2",
                        }
                    ]
                },
                {
                    "name": "Server 2",
                    "id": "server2",
                    "cities": [
                        {
                            "name": "Controller 3",
                            "id": "controller 3",
                        },
                        {
                            "name": "Controller 4",
                            "id": "controller 4",
                        }
                    ]
                }
            ]
        }
    ]
};



$.each(myJson.country, function (index, value) {
    var country_id;
    var state_id;
    var city_id;

        $("#country").append('<option rel="' + index + '" value="'+value.id+'">'+value.name+'</option>');

        $("#country").change(function () {
            $("#state, #city").find("option:gt(0)").remove();
            $("#state").find("option:first").text("Loading...");

            country_id = $(this).find('option:selected').attr('rel');
            console.log("Country INDEX : " + country_id);

            $.each(myJson.country[country_id].states, function (index1, value1) {
                $("#state").find("option:first").text("Choisir");
                $("#state").append('<option rel="' + index1 + '" value="'+value1.id+'">'+value1.name+'</option>');
            });

        });


        $("#state").change(function () {
            $("#city").find("option:gt(0)").remove();
            $("#city").find("option:first").text("Loading...");

            state_id = $(this).find('option:selected').attr('rel');
            console.log("State INDEX : " + state_id);

            $.each(myJson.country[country_id].states[state_id].cities, function (index2, value2) {
                $("#city").find("option:first").text("");
                $("#city").append('<option rel="' + index2 + '" value="'+value2.id+'">'+value2.name+'</option>');
            });


        });

});

 var doughnutData = [{
                value: 10,
                color: "#F7464A",
                highlight: "#FF5A5E",
                label: "Fail"
            }, {
                value: 90,
                color: "#46BFBD",
                highlight: "#5AD3D1",
                label: "Pass"
            },

        ];

      ;

	</script>
</body>

</html>